<template tag-name="lyte-calendar">
    <div class={{containerClass}} class="lyteCalendarPopup" ontouchstart={{action('record',event)}} ontouchend={{action('decide',event)}}>
        <div class='lyteCalendarView'>
            <div>
                <%if(navYield){%>
                    <lyte-yield yield-name="navigator"></lyte-yield>
                <%}else{%>

                    <div class='lyteCalendarNavigator {{if(ifEquals(ltPropHeaderAlignType,"centerdate"),"lyteCalHeaderCenterAlign","")}}'>
                        <span id={{monthDropdownId}} class="lyteVisuallyHidden">{{lyteUiI18n("lyte.calendar.choose.month")}}</span>
                        <span id={{yearDropdownId}} class="lyteVisuallyHidden">{{lyteUiI18n("lyte.calendar.choose.year")}}</span>
                        <span class="lyteVisuallyHidden"  aria-live="polite" id="{{headerId}}">
                            <% if( viewType === 'dateView' ) { %>
                                <span>{{lyteUiGetMonthOrYear(monthHeader,"M")}}</span><span>{{lyteUiGetMonthOrYear(monthHeader,"Y")}}</span>
                            <% } else if( viewType === 'monthView' ) { %>
                                <span>{{currentYear}}</span>
                            <% }
                            else { %>
                                <span>{{decadeStart}} - {{decadeEnd}}</span>
                            <% } %>
                        </span>
                        <% if(ifNotEquals(ltPropHeaderAlignType,"centerdate")) { %>
                            <span class="lyteCalsCalMon">
                                <% if( ltPropHeaderType === 'dropdown' || ltPropHeaderType === 'picklist' ){ %>
                                    <!-- <lyte-dropdown lt-prop-callout=true on-show={{method('setClass')}}  class="lyteCalMonthDD" lt-prop-options="{{monthNames}}" lt-prop-tabindex="1" on-option-selected="{{method('optionSelected','M')}}"></lyte-dropdown>
                                    <lyte-dropdown lt-prop-callout=true on-show={{method('setClass')}}  class="lyteCalYearDD" lt-prop-options="{{years}}" lt-prop-tabindex="2" on-option-selected="{{method('optionSelected','Y')}}"></lyte-dropdown> -->

                                    <lyte-dropdown lt-prop-aria-button={{monthAriaObj}} lt-prop-freeze="false" lt-prop={{stringify(ltPropDropdown)}} on-show={{method('setClass')}}  class="lyteCalMonthDD" on-option-selected="{{method('optionSelected','M')}}">
                                        <template is="registerYield" yield-name="yield">
                                            <lyte-drop-box>
                                                <lyte-drop-body>
                                                    <% monthNames.forEach(function(item,index){ %>
                                                        <lyte-drop-item data-value={{item}}>{{item}}</lyte-drop-item>
                                                    <% })%>
                                                </lyte-drop-body>
                                            </lyte-drop-box>
                                        </template>
                                    </lyte-dropdown>
                                    <% if( ltPropHeaderType === 'dropdown' ) { %>
                                        <lyte-dropdown lt-prop-aria-button={{yearAriaObj}} lt-prop-freeze="false" lt-prop={{stringify(ltPropDropdown)}} on-show={{method('setClass')}}  class="lyteCalYearDD" on-option-selected="{{method('optionSelected','Y')}}">
                                            <template is="registerYield" yield-name="yield">
                                                <lyte-drop-box>
                                                    <lyte-drop-body>
                                                        <% years.forEach(function(item,index){ %>
                                                            <lyte-drop-item data-value={{item}}>{{item}}</lyte-drop-item>
                                                        <% })%>
                                                    </lyte-drop-body>
                                                </lyte-drop-box>
                                            </template>
                                        </lyte-dropdown>
                                    <% } else { %>
                                        <lyte-picklist lt-prop-options={{years}} lt-prop-dropdown='{"freeze": false, "callout": true}' class="lyteCalYearDD" on-option-select="{{method('optionSelected','Y')}}" on-show={{method('setClass')}}>
                                        </lyte-picklist>
                                    <% } %>

                                <% } else if( ltPropHeaderType === 'drilldown' ) { %>
                                    <% if( viewType === 'dateView' ) { %>
                                        <span aria-label={{lyteUiI18n('lyte.calendar.monthview.drilldown.button')}} tabindex="0" role="button" class="lyteDrillCalHeaderButton" onclick={{action('changeToMonthView',event)}} onkeydown={{action('changeToMonthViewOnKeys',event)}}>
                                            <span class="lyteCalsCalMonth">{{lyteUiGetMonthOrYear(monthHeader,"M")}}</span>
                                            <span class="lyteCalsCalYear">{{lyteUiGetMonthOrYear(monthHeader,"Y")}}</span>
                                        </span>
                                    <% } else if( viewType === 'monthView' ) { %>
                                        <span aria-label={{lyteUiI18n('lyte.calendar.decadeview.drilldown.button')}} tabindex="0" role="button" class="lyteDrillCalHeaderButton" onclick={{action('changeToDecadeView',event)}} onkeydown={{action('changeToDecadeViewOnKeys',event)}}>
                                            <span class="lyteCalsCalYear">{{currentYear}}</span>
                                        </span>
                                    <% } else if( viewType === 'decadeView' ) { %>
                                        <span class="lyteDrillCalHeaderButton lyteDrillCalYearListHeader">
                                            {{decadeStart}} - {{decadeEnd}}
                                        </span>
                                    <% } %>
                                <% } else if( ltPropSelectionType === 'month' || ltPropSelectionType === 'year' ) { %>
                                    <% if( viewType === 'monthView' ) { %>
                                        <span>
                                            <span class="lyteCalsCalYear">{{currentYear}}</span>
                                        </span>
                                    <% } else if( viewType === 'decadeView' ) { %>
                                        <span class="lyteDrillCalHeaderButton lyteDrillCalYearListHeader">
                                            {{decadeStart}} - {{decadeEnd}}
                                        </span>
                                    <% } %>
                                <% } else { %>
                                    <span class="lyteCalsCalMonth">{{lyteUiGetMonthOrYear(monthHeader,"M")}}</span>
                                    <span class="lyteCalsCalYear">{{lyteUiGetMonthOrYear(monthHeader,"Y")}}</span>
                                <% } %>
                            </span>
                        <% } %>
                        
                        <% if(ifNotEquals(ltPropHeaderType,"dropdown")){ %>
                            <% if( showYear && ltPropSelectionType !== 'month' && ltPropSelectionType !== 'year' ) { %>
                                <span role="button" tabindex="0" class="lyteCalNav lyteCalyearNavLft" onclick="{{action('previous','Y',event)}}" onkeydown={{action('previousOnKeys','Y',event)}}>
                                    <span class="lyteVisuallyHidden">{{lyteUiI18n('lyte.calendar.previous.year')}}</span>
                                </span>
                            <% } %>
                        <% } %>
                        <span role="button" class="lyteCalNav lyteCaldLft {{lyteUiDisableCalendarNav(viewDate,'previous')}}" tabindex="0" onclick="{{action('previous','M',event)}}" onkeydown={{action('previousOnKeys','M',event)}}>
                            <span class="lyteVisuallyHidden">{{lyteUiI18n('lyte.calendar.previous.month')}}</span>
                        </span>
                        <% if(ifEquals(ltPropHeaderAlignType,"centerdate")){ %>
                            <span class="lyteCalsCalMon">
                                <% if( ltPropHeaderType === 'dropdown' || ltPropHeaderType === 'picklist' ){ %>
                                    <!-- <lyte-dropdown lt-prop-callout=true on-show={{method('setClass')}}  class="lyteCalMonthDD" lt-prop-options="{{monthNames}}" lt-prop-tabindex="1" on-option-selected="{{method('optionSelected','M')}}"></lyte-dropdown>
                                    <lyte-dropdown lt-prop-callout=true on-show={{method('setClass')}}  class="lyteCalYearDD" lt-prop-options="{{years}}" lt-prop-tabindex="2" on-option-selected="{{method('optionSelected','Y')}}"></lyte-dropdown> -->

                                    <lyte-dropdown lt-prop-aria-button={{monthAriaObj}} lt-prop-freeze="false" lt-prop={{stringify(ltPropDropdown)}} on-show={{method('setClass')}}  class="lyteCalMonthDD" on-option-selected="{{method('optionSelected','M')}}">
                                        <template is="registerYield" yield-name="yield">
                                            <lyte-drop-box>
                                                <lyte-drop-body>
                                                    <% monthNames.forEach(function(item,index){ %>
                                                        <lyte-drop-item data-value={{item}}>{{item}}</lyte-drop-item>
                                                    <% })%>
                                                </lyte-drop-body>
                                            </lyte-drop-box>
                                        </template>
                                    </lyte-dropdown>
                                    <% if( ltPropHeaderType === 'dropdown' ) { %>
                                        <lyte-dropdown lt-prop-aria-button={{yearAriaObj}} lt-prop-freeze="false" lt-prop={{stringify(ltPropDropdown)}} on-show={{method('setClass')}}  class="lyteCalYearDD" on-option-selected="{{method('optionSelected','Y')}}">
                                            <template is="registerYield" yield-name="yield">
                                                <lyte-drop-box>
                                                    <lyte-drop-body>
                                                        <% years.forEach(function(item,index){ %>
                                                            <lyte-drop-item data-value={{item}}>{{item}}</lyte-drop-item>
                                                        <% })%>
                                                    </lyte-drop-body>
                                                </lyte-drop-box>
                                            </template>
                                        </lyte-dropdown>
                                    <% } else { %>
                                        <lyte-picklist lt-prop-options={{years}} lt-prop-dropdown='{"freeze": false, "callout": true}' class="lyteCalYearDD" on-option-select="{{method('optionSelected','Y')}}" on-show={{method('setClass')}}>
                                        </lyte-picklist>
                                    <% } %>

                                <% } else if( ltPropHeaderType === 'drilldown' ) { %>
                                    <% if( viewType === 'dateView' ) { %>
                                        <span aria-label={{lyteUiI18n('lyte.calendar.monthview.drilldown.button')}} tabindex="0" role="button" class="lyteDrillCalHeaderButton" onclick={{action('changeToMonthView',event)}} onkeydown={{action('changeToMonthViewOnKeys',event)}}>
                                            <span class="lyteCalsCalMonth">{{lyteUiGetMonthOrYear(monthHeader,"M")}}</span>
                                            <span class="lyteCalsCalYear">{{lyteUiGetMonthOrYear(monthHeader,"Y")}}</span>
                                        </span>
                                    <% } else if( viewType === 'monthView' ) { %>
                                        <span aria-label={{lyteUiI18n('lyte.calendar.decadeview.drilldown.button')}} tabindex="0" role="button" class="lyteDrillCalHeaderButton" onclick={{action('changeToDecadeView',event)}} onkeydown={{action('changeToDecadeViewOnKeys',event)}}>
                                            <span class="lyteCalsCalYear">{{currentYear}}</span>
                                        </span>
                                    <% } else if( viewType === 'decadeView' ) { %>
                                        <span class="lyteDrillCalHeaderButton lyteDrillCalYearListHeader">
                                            {{decadeStart}} - {{decadeEnd}}
                                        </span>
                                    <% } %>
                                <% } else if( ltPropSelectionType === 'month' || ltPropSelectionType === 'year' ) { %>
                                    <% if( viewType === 'monthView' ) { %>
                                        <span>
                                            <span class="lyteCalsCalYear">{{currentYear}}</span>
                                        </span>
                                    <% } else if( viewType === 'decadeView' ) { %>
                                        <span class="lyteDrillCalHeaderButton lyteDrillCalYearListHeader">
                                            {{decadeStart}} - {{decadeEnd}}
                                        </span>
                                    <% } %>
                                <% } else { %>
                                    <span class="lyteCalsCalMonth">{{lyteUiGetMonthOrYear(monthHeader,"M")}}</span>
                                    <span class="lyteCalsCalYear">{{lyteUiGetMonthOrYear(monthHeader,"Y")}}</span>
                                <% } %>
                            </span>
                        <% } %>
                        <span role="button" class="lyteCalNav lyteCaldRgt {{lyteUiDisableCalendarNav(viewDate,'next')}}" tabindex="0" onkeydown={{action('nextOnKeys','M',event)}} onclick="{{action('next','M',event)}}">
                            <span class="lyteVisuallyHidden">{{lyteUiI18n('lyte.calendar.next.month')}}</span>
                        </span>
                        <% if(ifNotEquals(ltPropHeaderType,"dropdown")){ %>
                            <% if( showYear && ltPropSelectionType !== 'month' && ltPropSelectionType !== 'year' ) { %>
                                <span role="button" class="lyteCalNav lyteCalyearNavRgt" tabindex="0" onkeydown={{action('nextOnKeys','Y',event)}} onclick="{{action('next','Y',event)}}">
                                    <span class="lyteVisuallyHidden">{{lyteUiI18n('lyte.calendar.next.year')}}</span>
                                </span>
                            <% } %>
                        <% } %>
                    </div>
                <%}%>
                <!-- <div class="lyteCalTableContainerHeader">
                    
                </div> -->
            </div>
            <div class="lyteCalTableContainer" role="grid">
                <% if(ltPropBodyYield) { %>
                    <lyte-yield yield-name="body"></lyte-yield>
                <% } else { %>
                    <% if( viewType === 'dateView' ) { %>
                        <div role="row" class="lyteCalTableRowHeader">
                            <% if(ltPropWeekNumber) { %>
                                <div role="columnheader" class="lyteCalTableCellHeader lyteWeekNumberGrid" ><span>{{ltPropWeekNumHeader}}</span></div>
                            <% } %>
                            <% daysOfWeek.forEach( function( day, idod ) { %>
                                <div role="columnheader" aria-label={{day.title}} class={{day.class}} id={{day.id}}>{{lyteUiI18n(day.day)}}</div>
                            <% } )%>
                        </div>
                    <% } %>
                    <div class="lyteCalTableRowGroup">
                        <% if( viewType === 'dateView' ) { %>
                            <% matrix.forEach( function( vector, rowid ) { %>
                                <% if( !lyteUiCheckEmpty(vector) ) { %>
                                    <div class="lyteCalTableRow" role="row">
                                        <% if(ltPropWeekNumber) { %> 
                                            <div role="gridcell" tabindex="-1" lt-prop-title = "Week Number" lt-prop-tooltip-config = '{"position" : "right", "appearance" : "box"}' class="{{weeknum[rowid].class}}"><span >{{if(ifNotEquals(weeknum[rowid].val,0),weeknum[rowid].val,'')}}</span></div>
                                        <% } %>
                                        <% vector.forEach( function( date, cellid ) { %>
                                            <% if( lyteUiCheckInRange(ltPropMinDate,ltPropMaxDate,date.val,ltPropFormat) && !lyteUiDisabledDates( date, ltPropDisabledDates ) ) { %>
                                                <% if( date.emptyBlock) { %>
                                                    <div role="gridcell" class="lyteCalEmpty" data-selectable="false"></div>
                                                <% } else { %>
                                                    <div role="gridcell" tabindex="-1" id={{date.id}} aria-labelledby="{{concat(date.id, ' ', headerId, ' ', daysOfWeek[cellid]['id'])}}" onkeydown="{{action('performNavigation',event)}}" onclick="{{action('dateSelected',event)}}" class={{date.clsname}} data-date={{date.val}} data-iso="{{date.iso}}" data-selectable="true"><span class="lyteCalDateSpan">{{date.date}}</span></div>
                                                <% } %>
                                            <% } else { %>
                                                <% if( date.emptyBlock ) { %>
                                                    <div role="gridcell" class="lyteCalEmpty" data-selectable="false"></div>
                                                <% } else { %>
                                                    <div role="gridcell" lt-prop-title={{ltPropDisabledDateTooltip}} lt-prop-tooltip-config="{{ltPropTooltip}}" tabindex="-1" id={{date.id}} aria-labelledby="{{concat(date.id, ' ', headerId, ' ', daysOfWeek[cellid]['id'])}}" aria-disabled="true" onkeydown="{{action('performNavigation',event)}}"  data-date={{date.val}} data-iso="{{date.iso}}"  class={{date.clsname}} data-selectable="false"><span class="lyteCalDateSpan">{{date.date}}</span></div>
                                                <% } %>
                                            <% } %>
                                        <% } )%> 
                                    </div>
                                <% } %>
                            <% } ) %>    
                        <% } else if( viewType === 'monthView' ) { %>
                            <% monthViewData.forEach( function( row, rowIndex ) { %>
                                <div class="lyteCalTableRow">
                                    <% row.forEach( function( column, columnIndex ) { %>
                                        <div aria-label="{{lyteUiI18n(lyteUiGetLinearIndex(ariaMonthNames,rowIndex,columnIndex))}}" role="gridcell" tabindex="-1" onkeydown="{{action('performNavigation',event)}}" onclick={{action('monthSelected',event)}} class={{column['class']}} class="lyteCalTableCell" data-date={{column['systemValue']}}>
                                            {{column['displayValue']}}
                                        </div>
                                    <% } ) %>
                                </div>
                            <% } ) %>
                        <% } else if( viewType === 'decadeView' ) { %>
                            <% decadeViewData.forEach( function( row, rowIndex ) { %>
                                <div class="lyteCalTableRow">
                                    <% row.forEach( function( column, columnIndex ) { %>
                                        <% if(!column.emptyBlock) { %>
                                            <div role="gridcell" tabindex="-1" onkeydown="{{action('performNavigation',event)}}" onclick={{action('yearSelected',event)}} class="lyteCalTableCell {{column.class}}" data-date={{column.year}}>
                                                {{column.year}}
                                            </div>
                                        <% } else { %>
                                            <div role="gridcell" class="lyteCalEmpty">

                                            </div>
                                        <% } %>
                                    <% } ) %>
                                </div>
                            <% } )%>
                        <% } %>
                    </div>
                <% } %>
            </div>
            <div>
                <div class="lyteCalBtns">
                    <% if( showToday && ltPropShowToday && viewType==='monthView') { %>
                        <p role="button" tabindex="0" onkeydown={{action('curMonthOnKey',event)}} class="lyteCalCurrentDate"><a onclick="{{action('curMonth',event)}}">{{lyteUiI18n('Current Month')}}</a></p>
                    <% }else if( showToday && ltPropShowToday && viewType==='decadeView' ) { %>
                        <p role="button" tabindex="0" onkeydown={{action('curYearOnKey',event)}} class="lyteCalCurrentDate"><a onclick="{{action('curYear',event)}}">{{lyteUiI18n('Current Year')}}</a></p>
                    <% }else if( showToday && ltPropShowToday && viewType==='dateView' && ltPropSelectionType==='week' ) { %>
                        <p role="button" tabindex="0" onkeydown={{action('curWeekOnKey',event)}} class="lyteCalCurrentDate"><a onclick="{{action('curWeek',event)}}">{{lyteUiI18n('Current Week')}}</a></p>
                    <% }else if( showToday && ltPropShowToday ) { %>
                        <p role="button" tabindex="0" onkeydown={{action('todayOnKey',event)}} class="lyteCalCurrentDate"><a onclick="{{action('today',event)}}">{{lyteUiI18n('today')}}</a></p>
                    <% } %>
                    <% if( ltPropYield ) { %>
                        <lyte-yield yield-name="footer"></lyte-yield>
                    <% } %>
                </div>
            </div>
        </div>
    </div>
</template>