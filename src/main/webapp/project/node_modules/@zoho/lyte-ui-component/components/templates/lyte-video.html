<template tag-name="lyte-video">
    <div tabindex="0" aria-valuetext="video" class="lyteVideoContainer lyteVideoControlsShow" onpointerenter="{{action('mouseEnter',event, this )}}" onpointerleave="{{action('mouseLeave', this)}}" onpointermove="{{action('mouseMove',event, this )}}" onkeydown="{{action('keyDown', event)}}"  >
        <div class="lyteVideoAnimateWrapper lyteVideoAnimateBackward">
			<span class="lyteVideoAnimateBackArrow lyteVideoAnimateArrow3"></span>
			<span class="lyteVideoAnimateBackArrow lyteVideoAnimateArrow2"></span>
			<span class="lyteVideoAnimateBackArrow lyteVideoAnimateArrow1"></span>
        </div>
        <div class="lyteVideoAnimateWrapper lyteVideoAnimatePlay">
            <span class="lyteVideoAnimatePauseIcon"></span>
        </div>
        <div class="lyteVideoAnimateWrapper lyteVideoAnimateForward">
			<span class="lyteVideoAnimateForwardArrow lyteVideoAnimateArrow1"></span>
			<span class="lyteVideoAnimateForwardArrow lyteVideoAnimateArrow2"></span>
			<span class="lyteVideoAnimateForwardArrow lyteVideoAnimateArrow3"></span>
        </div>
        <%if((renderPrefetch && prefetchLoading == "lyteVideoPrefetchLoading") || ( !renderPrefetch && !canPlay ) ){%>
		<div class="lyteVideoPrefetchLoadingContainer {{if(initialLoad,'lyteVideoPrefetchInitialLoadingContainer', '')}}">
			<div class="lyteCircleLoader">
				<span class="lyteCircleInnerLoader"></span>
			</div>
		</div>
        <%}%>
        <canvas class="lyteVideoPoster {{if(hidePoster, 'lyteVideoPosterHide','')}} {{if(renderPrefetch, 'lyteVideoPosterBeforeVideoLoad','')}}" onclick="{{action('clickOnVideo')}}"></canvas>
        <%if(renderPrefetch){%>

            <div class="lyteVideoControls hoverControls lyteVideoPrefetchControlsContainer">
                <div class="lyteVideoProgressWrapper">
                    <div class="lyteVideoProgressBar"  >
                        <span class="lyteVideoProgressHandler" style="left: 0;"></span>
                    </div>    
                    <div class="lyteVideoTimer">
                            <time class="duration">{{currentDuration}}</time>
                            <span class="lyteVideoTimerSeparator">/</span>
                            <time >{{duration}}</time>
                    </div>
                </div>
                
                <div class="lyteVideoIconsWrap">
                    <div lyte-if="{{ltPropOptions.play != false}}" class="lyteVideoPlayPauseIconWrap">
                        <span class="lyteVideoIcons lyteVideoPlayIcon lyteVideoPaused" lt-prop-title="{{videoStatus}}" onclick="{{action('prefetch',this)}}"></span>
                    </div>
                    <div lyte-if="{{ltPropOptions.backward != false}}" class="lyteVideoRewind">
                        <span class="lyteVideoIcons lyteVideoRewindIcon" lt-prop-title="Play the video to enable controls"></span>
                    </div>
                    <div lyte-if="{{ltPropOptions.forward != false}}" class="lyteVideoForward">
                        <span class="lyteVideoIcons lyteVideoForwardIcon" lt-prop-title="Play the video to enable controls"></span>
                    </div>
                    <div lyte-if="{{ltPropOptions.volume != false}}" class="lyteVideoVolumeControls">
                        <span class="lyteVideoVolumeIcon" lt-prop-title="{{volumeStatus}}" onclick="{{action('mute',this)}}"></span>
                        <div class="lyteVideoVolumeSlider">
                            <lyte-multislider lt-prop-css-direction="ltr" lt-prop-max = '1' lt-prop-yield=true lt-prop-handler='lyteCircle' lt-prop-value = '[ { "value" : {{volume}}, "min" : 0, "max" : 1 } ]' on-change="{{method('setVolume')}}"></lyte-multislider>
                        </div>
                    </div>
                    <div class="lyteVideoRightIcons">
                        <div lyte-if="{{ltPropOptions.settings != false}}" class="lyteVideoSettings">
                            <span class="lyteVideoIcons lyteVideoSettingsIcon" lt-prop-title="Play the video to enable controls" ></span>
                        </div>
                        <% if( isNotFirefox ){ %>
                        <div lyte-if="{{ltPropOptions.pip != false}}" class="lyteVideoPip">
                            <span class="lyteVideoIcons lyteVideoPipIcon" lt-prop-title="Play the video to enable controls" ></span>
                        </div>
                        <% } %>
                        <div lyte-if="{{ltPropOptions.fullScreen != false}}" class="lyteVideoFullScreenControl">
                            <span class="lyteVideoIcons lyteVideoFullScreen" lt-prop-title="Play the video to enable controls"></span>
                        </div>
                    </div>
                
                </div>
            </div>
        <% }else{ %>
            <template lyte-if="{{ltPropMiniMode}}">
                <lyte-pip 
                    lt-prop-pip-mode="{{miniMode}}"
                    lt-prop-use-browser-api="false"
                    lt-prop-resize="{{miniModeOptions.resize}}"
                    lt-prop-draggable="{{miniModeOptions.draggable}}" 
                    lt-prop-resize-max-width="{{miniModeOptions.resizeMaxWidth}}"
                    lt-prop-resize-min-width="{{miniModeOptions.resizeMinWidth}}"
                    lt-prop-resize-max-height="{{miniModeOptions.resizeMaxHeight}}"
                    lt-prop-resize-min-height="{{miniModeOptions.resizeMinHeight}}"
                    lt-prop-header-yield="{{miniModeOptions.headerYield}}"
                    lt-prop-footer-yield="{{miniModeOptions.footerYield}}"
                    lt-prop-pip-window-width="{{miniModeOptions.miniWindowWidth}}"
                    lt-prop-pip-window-height="{{miniModeOptions.miniWindowHeight}}"
                    >
                    <template is="registerYield" yield-name="header">
                        <lyte-yield yield-name="header"></lyte-yield>
                    </template>
                    <template is="registerYield" yield-name="video">
                        <div class="lyteVideoMiniContainer" onpointerenter="{{action('mouseEnter',event, this )}}" onpointerleave="{{action('mouseLeave', event, this )}}" onpointermove="{{action('mouseMove',event, this )}}">
                            <div class="lytePipFullScreenIconContainer" onclick="{{action('toggleMiniMode')}}">
                                <div class="lytePipFullScreenIcon"></div>
                            </div>
                            <div class="lytePipCloseIconContainer" onclick="{{action('toggleMiniMode', true )}}">
                                <div class="lytePipCloseIcon"></div>
                            </div>
                        </div>
                    </template>
                    <template is="registerYield" yield-name="footer">
                        <lyte-yield yield-name="footer"></lyte-yield>
                    </template>
                </lyte-pip>
            </template>
            <!-- <template lyte-else> -->
                <video  class="lyteVideo" 
                    onvolumechange="{{action('changeVolume',event)}}" 
                    preload="{{ltPropPreLoad}}" 
                    ontimeupdate="{{action('update',event)}}"  
                    onloadeddata="{{action('progress', event)}}" 
                    onprogress="{{action('progress', event )}}" 
                    onloadedmetadata="{{action('meta', event)}}" 
                    onpause="{{action('pause', event )}}" 
                    onplay="{{action('play', event )}}" 
                    onclick="{{action('clickOnVideo')}}"  
                    ondblclick="{{action('toggleFullScreen')}}"
                    oncanplay="{{action('onCanPlay')}}"
                    onwaiting="{{action('onWaiting', false)}}"
                    onplaying="{{action('onWaiting', true)}}"
                    >
                    <source src="{{ltPropSource[0].src}}" type="{{ltPropSource[0].type}}" label="{{ltPropSource[0].label}}" size="{{ltPropSource[0].size}}" >
                    <% if( ltPropTracks ) { %>
                        <track> 
                    <% } %>
                </video>
                <% if( subtitles ) { %>
                    <div class="lyteVideoSubtitleWrapper">
                        <p class="lyteVideoSubtitle">{{subText}}</p>
                    </div>
                <% } %>
                <div class="lyteVideoControls hoverControls">
                    <div class="lyteVideoProgressWrapper">
                        <div class="lyteVideoProgressBar" role="slider" aria-label="Seek Slider" aria-valuemin="0" aria-valuemax="{{durationSec}}" aria-valuenow="{{elapsedTime}}" aria-valuetext="" tabindex="0" onclick="{{action('progressClick',event)}}" onmousemove="{{action('updateToolTip',event)}}"  >
                            <div class="lyteVideoToolTip" lyte-if="{{!miniMode}}">
                                <div>
                                    <p class="lyteVideoTooltipChapterName">{{toolTip.name}}</p>
                                    <p class="lyteVideoTooltipCurrentTime">{{toolTip.time}}</p>
                                </div>
                            </div>
                            <% if( chaptersData ){ %>
                                <div class="lyteVideoChapterWrapper">
                                <% chaptersData.forEach( function(item, index){ %>
                                    <div class="lyteVideoChapter" data-start="{{item.startTime}}" data-end="{{item.endTime}}" data-label="{{item.title}}" style="width: {{item.width}}%;">
                                        <span class="lyteVideoProgressed" style="width: {{item.time}}%;" ></span>
                                        <span class="lyteVideoProgressLoad" style=" width : {{item.loadedTime}}%"></span>
                                    </div>
                                <% }) %>   
                                </div>
                            <% } else{ %>
                                <span class="lyteVideoProgressed" style="width: {{elapsedTime}}%;" ></span>
                                <span class="lyteVideoProgressLoad" style=" width : {{loadedTime}}%"></span>
                            <% } %>
                            <span class="lyteVideoProgressHandler"  ontouchstart="{{action('progressMouseDown',event)}}" onmousedown="{{action('progressMouseDown',event)}}" style="left: 0;"></span>
                        </div>    
                        <div class="lyteVideoTimer">
                                <time class="duration">{{currentDuration}}</time>
                                <span class="lyteVideoTimerSeparator">/</span>
                                <time >{{duration}}</time>
                        </div>
                    </div>
                    
                    <div class="lyteVideoIconsWrap">
                        <div tabindex="0" aria-keyshortcuts="k" aria-label="{{videoStatus}} keyboard shortcut k" lyte-if="{{ltPropOptions.play != false}}" class="lyteVideoPlayPauseIconWrap" onclick="{{action('togglePlayPause',this)}}">
                            <span class="lyteVideoIcons lyteVideoPlayIcon lyteVideoPaused" lt-prop-title="{{videoStatus}} (k)"></span>
                        </div>
                        <div tabindex="0" aria-label="{{lyteUiI18n('lyte.video.skip.backward')}}" lyte-if="{{ltPropOptions.backward != false}}" class="lyteVideoRewind" onclick="{{action('skipVideo','rewind')}}">
                            <span class="lyteVideoIcons lyteVideoRewindIcon {{backwardStatus}}" lt-prop-title="{{lyteUiI18n('lyte.video.skip.backward')}}" ></span>
                        </div>
                        <div tabindex="0" aria-label="{{lyteUiI18n('lyte.video.skip.forward')}}" lyte-if="{{ltPropOptions.forward != false}}" class="lyteVideoForward" onclick="{{action('skipVideo','forward')}}">
                            <span class="lyteVideoIcons lyteVideoForwardIcon {{forwardStatus}}" lt-prop-title="{{lyteUiI18n('lyte.video.skip.forward')}}" ></span>
                        </div>
                        <div lyte-if="{{ltPropOptions.volume != false}}" class="lyteVideoVolumeControls">
                            <span tabindex="0" aria-label="{{volumeStatus}} keyboard shortcut m" aria-keyshortcuts="m" class="lyteVideoVolumeIcon" lt-prop-title="{{volumeStatus}} (m)" onclick="{{action('mute',this)}}"></span>
                            <div class="lyteVideoVolumeSlider">
                                <lyte-multislider lt-prop-aria="true" lt-prop-css-direction="ltr" lt-prop-max = '1' lt-prop-yield=true lt-prop-handler='lyteCircle' lt-prop-value = "{{sliderData}}" on-change="{{method('setVolume')}}" lt-prop-tabindex = -1></lyte-multislider>
                            </div>
                        </div>
                        <div class="lyteVideoRightIcons">
                            <div tabindex="0" aria-label="{{lyteUiI18n('lyte.video.settings')}}" lyte-if="{{ltPropOptions.settings != false}}" class="lyteVideoSettings" onclick="{{action('toggleSettings',event)}}">
                                <span class="lyteVideoIcons lyteVideoSettingsIcon" lt-prop-title="{{lyteUiI18n('lyte.video.settings')}}" ></span>
                            </div>
                            <div lyte-if="{{ltPropOptions.settings != false}}" role="menu" class="lyteVideoSettingsWrapper lyteVideoSettingsItemHover  lyteVideoMenuHide" onmouseover="{{action('mouseOver')}}">
                                <% if( subMenuOpened ){ %>
                                    <div data-value="back" role="menuitem" tabindex="0" class="lyteVideoSettingsDropdownHead" onclick="{{action('settingsMenuClick',this)}}" >
                                        <div class="lyteVideoSettingsBackIcon"></div>
                                        <span class="lyteVideoSettingsLabel">{{lyteUiI18n(lyteUiConcat('lyte.video.menu.',selectedOption))}}</span>
                                    </div>
                                <% } %>
                        
                                <% switch( selectedOption ){ 
                                    case 'playBackSpeed' : 
                                    speedData.forEach( function( item, index ){ %>
                                    <div tabindex="0" role="menuitem" aria-label="{{item.label}}" data-value = {{item.label}} class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass(item.label, ltPropPlayRate)}}" onclick="{{action('settingsMenuClick',this)}}" >
                                        <span class="lyteVideoSettingsLabel">{{item.label}} </span>
                                    </div>
                                <%}); break;
                                case 'qualityOption' : %>
                                <div tabindex="0" role="menuitem" aria-label="{{lyteUiI18n('lyte.video.menu.qualityOption.auto')}}" data-value = "auto" class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass('auto', ltPropQuality)}}" onclick="{{action('settingsMenuClick',this)}}" >
                                    <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.qualityOption.auto")}}</span>
                                    </div>   
                                <% ltPropSource.forEach( function( item, index ){ %>
                                    <div tabindex="0" role="menuitem" lyte-if="{{item.size}}" aria-label="{{item.size}}" data-value = {{item.size}} class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass(item.size, ltPropQuality)}}" onclick="{{action('settingsMenuClick',this)}}" >
                                        <span class="lyteVideoSettingsLabel">{{item.size}} </span>
                                    </div>
                                <%}); break; 
                                    case 'subtitles' : %>
                                    <div tabindex="0" role="menuitem" aria-label="{{lyteUiI18n('lyte.video.menu.subtitles.off')}}"  data-value = "off" class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass('off', ltPropCaption)}}" onclick="{{action('settingsMenuClick',this)}}" >
                                        <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.subtitles.off")}}</span>
                                    </div> 
                                    <% ltPropTracks.forEach( function( item, index ){ %>
                                    <div tabindex="0" role="menuitem" aria-label="item.label" data-value = {{item.label}} class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass(item.label, ltPropCaption)}}" onclick="{{action('settingsMenuClick',this)}}" >
                                        <span class="lyteVideoSettingsLabel">{{item.label}} </span>
                                    </div> 
                                <%}); break;
                                    default : %>
                                    <div tabindex="0" role="menuitem" aria-haspopup="true" aria-label="{{lyteUiI18n('lyte.video.menu.subtitles')}}" data-value="subtitles" class="lyteVideoSettingsItem " onclick="{{action('settingsMenuClick',this)}}">
                                        <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.subtitles")}} </span>
                                        <span class="lyteVideoSettingsKey">{{lyteUiI18n(lyteUiConcat('lyte.video.menu.subtitles.',ltPropCaption))}}</span>
                                    </div> 
                                    <div tabindex="0" role="menuitem" aria-haspopup="true" aria-label="{{lyteUiI18n('lyte.video.menu.playBackSpeed')}}" data-value="playBackSpeed" class="lyteVideoSettingsItem" onclick="{{action('settingsMenuClick',this)}}">
                                        <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.playBackSpeed")}} </span>
                                        <span class="lyteVideoSettingsKey">{{ltPropPlayRate}}</span>
                                    </div>
                                    <div tabindex="0" role="menuitem" aria-haspopup="true" aria-label="{{lyteUiI18n('lyte.video.menu.qualityOption')}}" data-value="qualityOption" class="lyteVideoSettingsItem" onclick="{{action('settingsMenuClick',this)}}">
                                        <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.qualityOption")}} </span>
                                        <span class="lyteVideoSettingsKey">{{getQualityI18n(ltPropQuality)}}</span>
                                    </div> 
                                    <% } %>        
                            </div>
                            <div tabindex="0" aria-label="{{lyteUiI18n('lyte.video.mode.miniMode')}}" lyte-if="{{ltPropMiniMode}}" class="lyteVideoPip" onclick="{{action('toggleMiniMode')}}">
                                <span class="lyteVideoIcons lyteVideoPipIcon" lt-prop-title="{{lyteUiI18n('lyte.video.mode.miniMode')}}" ></span>
                            </div>
                            <% if( isNotFirefox ){ %>
                            <div tabindex="0" aria-label="{{lyteUiI18n('lyte.video.mode.pip')}}" lyte-if="{{ltPropOptions.pip != false}}" class="lyteVideoPip" onclick="{{action('togglePip')}}">
                                <span class="lyteVideoIcons lyteVideoPipIcon" lt-prop-title="{{lyteUiI18n('lyte.video.mode.pip')}}" ></span>
                            </div>
                            <% } %>
                            <div tabindex="0" aria-keyshortcuts="f" aria-label="{{lyteUiI18n('lyte.video.mode.fullScreen')}} keyboard shortcut f" lyte-if="{{ltPropOptions.fullScreen != false}}" class="lyteVideoFullScreenControl" onclick="{{action('toggleFullScreen',this)}}">
                                <span class="lyteVideoIcons lyteVideoFullScreen" lt-prop-title="{{lyteUiI18n('lyte.video.mode.fullScreen')}} (f)" ></span>
                            </div>
                        </div>
                    
                    </div>
                </div>
            <!-- </template> -->
        <% }%>
        
    </div>
</template>